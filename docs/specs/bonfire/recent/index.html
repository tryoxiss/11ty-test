<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bonfire Recent Draft</title>

    <link rel="stylesheet" href="/res/style.css">
    <link rel="stylesheet" href="/res/prism.css">

</head>
<body class="match-braces">
    <script src="/res/prism.js"></script>
    
    <header>
        <h1>Bonfire Recent Draft</h1>

        <p class="subtitle">

            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line><path d="M8 14h.01"></path><path d="M12 14h.01"></path><path d="M16 14h.01"></path><path d="M8 18h.01"></path><path d="M12 18h.01"></path><path d="M16 18h.01"></path></svg>Updated Date Undefined
        </p>
    </header>
    
    <main>
        <p>Bonfire is a working (and temporary) name for a standard to allow for community-divided federated instant messaging. In laymans terms, its federated discord.</p>
<blockquote class="callout callout--info">
    <!-- <svg src="/_shared-content/lucide/alert-triangle.svg" color="red"></svg> -->
    <div class="callout__header">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-info"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
        <p>This specification is a draft!</p>
    </div>
    <p>it is not finished and is due for many, many revisions down the road. </p>
</blockquote>
<blockquote class="callout callout--warning">
    <!-- <svg src="/_shared-content/lucide/alert-triangle.svg" color="red"></svg> -->
    <div class="callout__header">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path><path d="M14 2v6h6"></path><path d="m3 12.5 5 5"></path><path d="m8 12.5-5 5"></path></svg>
        <p>Dependy Issue</p>
    </div>
    <p>This specification seems to refrence or cite 1 or more speicfications that appear to be missing. These issues must be resolved before 1.0. A list can be found below: </p>
    <ul style="margin-top: -1rem;">
        <li>Clean ID System</li>
    </ul>
</blockquote>
<h2>Definitions</h2>
<p>Let the keywords that follow be case insensitive unless otherwise specified.</p>
<ul>
<li>Let the keywords &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, and &quot;MAY&quot; (and lowercase equivalents) be defined as specified in <a href="https://www.rfc-editor.org/rfc/rfc2119">RFC:2119</a></li>
<li>Let <code>incorrect</code> mean MUST NOT; as in, incorrect behaviour violates the standard.</li>
<li>Let <code>i&lt;int&gt;</code> represent 2^int-1. Some examples (and the important ones) are as follows;
<ul>
<li><code>i6</code> equals <code>63</code></li>
<li><code>i8</code> equals <code>255</code></li>
<li><code>i16</code> equals <code>65,535</code></li>
<li><code>i32</code> equals <code>2,147,483,647</code></li>
<li><code>i64</code> equals approximately <code>1.844674407×10¹⁹</code></li>
</ul>
</li>
<li>Let <code>JSON Object</code>, <code>Object</code>, or <code>Packet</code> represent one JSON object, and any nested objects thereforth. Let this not exceed the maximum status characters of an i16.</li>
<li>Let <code>packet</code> represent one XML object sent between a client-server, or server-server relationship.</li>
<li>Let <code>snake_case</code> and <code>snake case</code> mean the naming scheme where multiple words are written in all lowercase and are seperated with underscores.</li>
<li><s>Let <code>CID</code> and mean any valid ID from the the <a href="/specs/cid/recent/">clean ID system</a>.</s></li>
<li>Let <code>GUID</code> and <code>UUID</code> represent a <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">Universally Unique Identifier</a>.</li>
<li>Let the character sets <code>reserved</code>, <code>escaped</code>, <code>delims</code>, <code>unwise</code>, <code>lowalpha</code>, <code>upalpha</code>, <code>alpha</code>, <code>digit</code>, <code>alphanum</code>, <code>mark</code> and <code>unreserved</code> are to be defined as in <a href="https://www.ietf.org/rfc/rfc2396.txt">RFC:2396</a>. This is only when these keywords are in reference to a <strong>character set</strong>.</li>
<li>Let <code>inalpha</code> represent the character set including <code>upalpha</code> and <code>lowalpha</code>, where no distinction is made between uppercase and lowercase. (&quot;A&quot; is the same as &quot;a&quot;).</li>
<li>Let the character set <code>safe</code> be the culmination of <code>inalpha</code> and <code>digit</code> and the characters <code>_</code> and <code>-</code>.</li>
</ul>
<h2>Design Philosophy</h2>
<p>*Some of the following definitions are from <a href="https://ariadne.space/2019/01/07/activitypub-the-worse-is-better-approach-to-federated-social-networking/">ariadne.space's post on ActivityPub's design falings</a>.</p>
<ul>
<li><strong>Simplicity</strong>: The standard and protocol should be simple to implement. It is much more important for the protocol and standard to be simple than the backend implementation.</li>
<li><strong>Cleanliness</strong>: The standard must be clean and easily usable from a end-user perspective. It is more important for it to be clean and simple for end-users than the backend implementation.</li>
<li><strong>Correctness</strong>: All packets and URI's must be verifiably correct or incorrect. It MUST NOT ever be unclear.</li>
<li><strong>Safety</strong>: The standard and protocol is designed in a way that is safe, any unsafe implementations are considered incorrect.</li>
<li><strong>Completeness</strong>: The standard and protocol must cover all reasonably expected situations.</li>
<li><strong>Privacy</strong>: All content should be encrypted and sent through secure channels. It is considered incorrect to send unencrypted data with the exception of pre-written public HTML pages.</li>
<li><strong>Prevent Consolidation</strong>: We don't want this to end up like email, where you <em>can</em> self host and join a smaller provider, but good luck with all the limitations in place.</li>
</ul>
<p>Other, smaller goals are to make it extensible so at no point will there ever be breaking changes (No &quot;bonfire 2.0&quot;). While we cannot guarantee this, a finished 1.0 spec should be backwards compatible for at least the next 30 years, while still being able to add support for new features.</p>
<h2>Conventions followed</h2>
<ul>
<li>Variables and XML Objects will be denoted in snake case. (<code>variable_name</code>)</li>
<li>Variables in code which remain constant should be all capitalised. (<code>VARIABLE_NAME</code>)</li>
</ul>
<h2>Objects</h2>
<p>Objects are just how we send stuff store it however you please, ideally SQL.</p>
<h3>Accounts</h3>
<p>An account is an object that represents a <code>person</code> in nature. Its XML Object is as follows. It also contains the defult values for privacy. Anything that does not have a <code>visibility</code> field cannot have its visibility edited.</p>
<pre><code class="language-json">{ 
    &quot;@context&quot;: {
        &quot;spec&quot;: &quot;https://tryoxiss.github.io/specs/bonfire/recent/&quot;,
        &quot;lang&quot;: &quot;en&quot;
    },
    
    &quot;guid&quot;: &quot;000000000-0000-5000-0000-000000000000&quot;,
    
    &quot;display_name&quot;: &quot;Alice&quot;,

    &quot;handle&quot;: { 
        &quot;username&quot;: &quot;alice&quot;,
        &quot;discriminator&quot;: &quot;0001&quot;,
        &quot;instance&quot;: &quot;example.social&quot;
    }, 

    &quot;icon&quot;: { 
        &quot;full&quot;: &quot;https://res.example.net/pfp/1234:5678:9abc:defg:hijk:lmno:pqrs:tuvw:0001.png&quot;,
        &quot;255&quot;: &quot;https://res.example.net/pfp/1234:5678:9abc:defg:hijk:lmno:pqrs:tuvw:0001@255px.png&quot;,
        &quot;90&quot;: &quot;https://res.example.net/pfp/1234:5678:9abc:defg:hijk:lmno:pqrs:tuvw:0001@90px.png&quot;,
        &quot;40&quot;: &quot;https://res.example.net/pfp/1234:5678:9abc:defg:hijk:lmno:pqrs:tuvw:0001@40px.png&quot;
    },

    &quot;banner&quot;: { 
        &quot;full&quot;: &quot;https://res.example.net/bannar/1234:5678:9abc:defg:hijk:lmno:pqrs:tuvw:0001.png&quot;
    },

    &quot;colors&quot;: { 
        &quot;primary&quot;: &quot;#512BD4&quot;,
        &quot;username&quot;: &quot;#512BD4&quot;
    },

    &quot;status&quot;: { 
        &quot;visibility&quot;: &quot;friends&quot;,
        &quot;type&quot;: &quot;plain&quot;,
        &quot;activity&quot;: &quot;online&quot;,
        &quot;emoji&quot;: &quot;♥️&quot;, 
        &quot;text&quot;: &quot;Avatar!&quot;
    },

    &quot;connections&quot;: { 
        // asdasda
    }, 

    &quot;friends&quot;: [
        {&quot;visibility&quot;: &quot;everyone&quot;},
        {
            &quot;guid&quot;: &quot;GUID1&quot;,
            &quot;nickname&quot;: &quot;your nick &lt;3&quot;,
            &quot;note&quot;: &quot;your note on them&quot;, 
            &quot;other info&quot;: &quot;sotre whatever custom fields you want!&quot;
        }, {
            &quot;guid&quot;: &quot;GUID2&quot;,
        }, {
            &quot;guid&quot;: &quot;GUID1&quot;,
        }, {
            &quot;guid&quot;: &quot;GUID2&quot;,
        }
    ],

    &quot;blocked&quot;: [{
            &quot;guid&quot;: &quot;GUID1&quot;,
            &quot;note&quot;: &quot;your note on them&quot;, 
        }, {
            &quot;guid&quot;: &quot;GUID2&quot;,
        }, {
            &quot;guid&quot;: &quot;GUID1&quot;,
        }, {
            &quot;guid&quot;: &quot;GUID2&quot;
        }],

    &quot;hubs&quot;: [
        {&quot;visibility&quot;: &quot;friend_and_mutual&quot;},
        {
            &quot;guid&quot;: &quot;GUID1&quot;,
        }, {
            &quot;guid&quot;: &quot;GUID2&quot;,
        }, {
            &quot;guid&quot;: &quot;GUID1&quot;,
        }, {
            &quot;guid&quot;: &quot;GUID2&quot;
        }
    ],

    &quot;pronouns&quot;: [&quot;she/they&quot;, &quot;she/her&quot;, &quot;they/them&quot;],
    // the frist one is shown, then seperated by slashes and when hovered it will show the one at that index
    // So if you have &quot;she/they&quot; and you hover &quot;she&quot; with the array above, it will show a tooltip saying &quot;she/her&quot;

    &quot;links&quot;: [{ 
            &quot;rel&quot;: &quot;nofriend&quot;, // UNVERIFIED
            &quot;icon&quot;: &quot;mastodon&quot;,
            &quot;link&quot;: &quot;@username@example.social&quot;, 
            &quot;visibility&quot;: &quot;everyone&quot;
        }, { 
            &quot;rel&quot;: &quot;me&quot;, // VERIFIED
            &quot;icon&quot;: &quot;peertube&quot;,
            &quot;link&quot;: &quot;@username@joinpeertube.org&quot;,
            &quot;visibility&quot;: &quot;everyone&quot;
        }
    ],

    &quot;public_key&quot;: &quot;999b9af08579802c4d1ca35070b179d610754abd2d601284819493a55e9ce760e1bc9b8adc6f9592311546f88f43237c65577ca7db95919945e63bfbb241b7b6&quot;,

    &quot;prefrences&quot;: {
        &quot;visibility&quot;: &quot;private&quot;

        // maybe include ALL visabilities in &quot;prefrences&quot;?
    }
}

</code></pre>
<p>XML SHOULD work with the recommended database (MariaDB; recommended because you can easily self-host. All of its features are entirely free, open source, and handles large data loads well. You can pay for them to host it with addons like redundant data though). <a href="https://mariadb.com/kb/en/what-data-type-should-i-use-to-store-xml-natively-in-the-database/">^1</a>.</p>
<p>For a users GUID, you generate a GUIDv1, and then the result of that that and the users inputted username on signup (this WILL NOT change when they change their username. Their GUID is their GUID for life unless reset*) will be fed in to create a GUIDv5. The users default tag is generated with the first 14 bytes from their guid, if the tag would be <code>0000</code>, or is above <code>#9999</code>, then they instead read the next 14 bits. If no string resulting in a non-zero tag is found, the tag is set to be <code>#0001</code>. if it goes above, until the end, then they are instead automatically assigned the tag <code>#9999</code>.</p>
<p>When mentioning users, any of the following structures can be used, as long as one would bring it down to just one user in the current hub.</p>
<p>A user's CID is 8 segments long. For this example we will analyse <code>0s9h:3t0r:mqcs:xzpy:vwfg99:5d0s:zd0fg:7z9o</code></p>
<ul>
<li>The first 4 segments denote the first 16 characters displayed as safe of the ??? of the UNIX timestamp to millaseccond percision that they joined on, dis</li>
<li>The following 3 segments denote the first 12 characters of the ??? hash of current instance instances domain (e.g., ??? hash of &quot;example.com&quot;).</li>
<li>The final segment is a rabdom number generated based on the conbined string of your countrys code and the current timezone your computer is set to. [!CHANGE MAYBE!]</li>
</ul>
<p>This has a small, but existent chance for collisions, due to seeding. Which means that ALL IDs must be checked before going through. If a collision woulf occur, simply automatically send the request again as soon as it recives the denined response, it can simply resend it. This can occuur up to thirty times before giving a &quot;Singup Failed&quot; response to the user.</p>
<pre><code class="language-plaintext">@username
@username#1234
@username@example.net
@username#1234@example.net
</code></pre>
<p>an account suspended by the instance will add the <code>suspended</code> keyword to the <code>&lt;account&gt;</code> object, such as <code>&lt;account type=&quot;person&quot; suspended&gt;</code>.</p>
<p>When an account is suspended, all mentions of them should display as <code>@suspended#0000</code>.</p>
<p>Deleted accounts should instead be removed from the database entirely, and their mentions should be replaced with <code>@unknown#0000</code>. If they simply moved to another instance, their mentions should update accordingly.</p>
<h3>Messages</h3>
<p>A status object can represent a reaction, message, creation, or anything else that is not a <code>person</code> or <code>bot</code> in nature.</p>
<p>Creation:</p>
<pre><code class="language-json">{ 
    &quot;@context&quot;: {
            &quot;spec&quot;: &quot;https://tryoxiss.github.io/specs/bonfire/recent/&quot;,
            &quot;lang&quot;: &quot;en&quot;,
        },
    &quot;request&quot;: &quot;CREATE&quot;,
    &quot;type&quot;: &quot;message&quot;,
    &quot;author&quot;: &quot;000000000-0000-5000-0000-000000000000&quot;,
    &quot;adressed&quot;: [&quot;000000000-0000-5000-0000-000000000000&quot;, &quot;000000000-0000-5000-0000-000000000000&quot;], 
    &quot;content&quot;: &quot;What does the message contain? Remember to escape doubble quotes with a backslash! \\! if the server recieves an invalid object, it will ignore it!&quot;,
    &quot;time&quot;: &quot;1673475563&quot;,
    &quot;signature&quot;: &quot;&quot;
}
</code></pre>
<h2>Federation</h2>
<p>Bonfire uses a protocol similar to <a href="https://diaspora.github.io/diaspora_federation/federation/magicsig.html">Diaspora*</a> protocol. It is yet unfinished as its specifics are not relevent to the design elegance of Bonfire.</p>
<h2>URI Scheme</h2>
<p>The <code>bonfire://</code> URI scheme is motivated by the desire to have a clean inter-instance and inter-client way to denote various locations. This does not need to denote actions as those are sent in <strong>packets</strong> instead. However, they can include links <em>to</em> actions like joining a hub or being an invite.</p>
<p>Generally, it follows a <code>action:what:details</code> scheme, however when UUIDs are involved they are instead surrounded by forward slashes.</p>
<pre><code>bonfire://invite/guid
<p>Generally, it follows a <code>action:what:details</code> scheme, however when CIDs are involved they are instead surrounded by forward slashes.</p>
<p>Hub CIDs MUST include the instance at the begining in the following format: <code>CID:sub.domain.tld</code>. This allows URIs to be cleaner.</p>
<pre><code>bonfire://invite/cid

( bonfire://invite/1233:45::671: )
( bonfire://invite/13fg:45::6io: )

bonfire://view:@username#0000@instance.tld

( bonfire://view:@tryoxiss#8100@bonfire.example.net )
( bonfire://view:@khaim#0919@app.instance.tld )

bonfire://view/guid#channel
</code></pre>

    </main>

    
<footer>
    

    <ul>
        <li><a href="#" class="dead-link"><b>Credits</b></a></li>
        <li><a href="https://www.11ty.dev/">11ty</a> (SSG)</li>
        <li><a href="https://prismjs.com/">prism.js</a> (Syntax Hilighting)</li>
        <li><a href="https://lucide.dev/">Lucide Icons</a></li>
    </ul>

    <ul>
        <li><b>Theme</b></li>
        <li><a href="/specs/milkshake/2.0/" class="dead-link">Milkshake 2.0 Theme</a></li>
        <li><a href="https://github.com/catppuccin/catppuccin">catppuccin</a></li>
        <li><a href="https://lucide.dev/">Lucide Icons</a></li>
    </ul>

    <ul>
        <li><a href="/projects/" class="dead-link"><b>Our Stuff!</b></a></li>
        <li><a href="/specs/bonfire/">Bonfire</a> Drafts, Project Codename</li>
    </ul>

    <ul>
        <li><b>Developement</b></li>
        <li><a href="https://github.com/tryoxiss/tryoxiss.github.io">Source</a></li>
        <li><a href="https://github.com/tryoxiss/tryoxiss.github.io/issues">Issues</a></li>
        <li><a href="https://github.com/tryoxiss/tryoxiss.github.io/commit/master">Deployment Status</a></li>
        <li><a href="/debug/">Build Info</a></li>
    </ul>

    <br>
    <p class="subtitle">Most content on this site is copyright &copy; tryoxiss 2022 or later. Feel free to use any of my content without asking though, just credit me and don't use it for any <a href="/dict/profanity/" class="dead-link">profanity</a> and I will probably be good. Though I do reserve the right to make you stop using it at any time for any reason.</p>
</footer>

</body>
</html>